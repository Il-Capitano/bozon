import counting_resource;

function test(i: i32)
{
	let a = counting_resource_t();
	let _ = switch (i) {
		0 => counting_resource_t(),
		1 => a,
		2 => move a,
		3 => move a,
		4 => {
			let v = counting_resource_t();
			v
		},
		5 => {
			let v = counting_resource_t();
			move v
		},
		6 => {
			let v = move a;
			v
		},
		7 => {
			let v = move a;
			move v
		},
		else => unreachable,
	};
}

function main() -> i32
{
	test(0);
	if (!counting_resource_is_valid())
	{
		return 1;
	}
	test(1);
	if (!counting_resource_is_valid())
	{
		return 1;
	}
	test(2);
	if (!counting_resource_is_valid())
	{
		return 1;
	}
	test(3);
	if (!counting_resource_is_valid())
	{
		return 1;
	}
	test(4);
	if (!counting_resource_is_valid())
	{
		return 1;
	}
	test(5);
	if (!counting_resource_is_valid())
	{
		return 1;
	}
	test(6);
	if (!counting_resource_is_valid())
	{
		return 1;
	}
	test(7);
	if (!counting_resource_is_valid())
	{
		return 1;
	}
	return 0;
}
