function print(str: str) -> void;
function println(str: str) -> void;
function print_int32(n: int32) -> void;
function print_uint32(n: uint32) -> void;
function print_int32_ptr(p: *const int32) -> void;
function print_float64(x: float64) -> void;

function factorial(n: int32) -> int32
{
	let i = 1;
	let res = 1;
	while (i <= n)
	{
		res = res * i;
		i -= -1;
	}
	return res;
}

function factorial_recursive(n: int32) -> int32
{
	if (n <= 1)
	{
		return 1;
	}
	else
	{
		return n * factorial_recursive(n - 1);
	}
}

function main() -> int32
{
	println("");
	println("hello");
	print_int32(123);
	print_int32(factorial(5));
	println("hello again!!!!\nand on a new line\n");

	foo();

	let good = true;
	let i = 0;
	while (i < 20)
	{
		if (factorial(i) != factorial_recursive(i))
		{
			good = false;
		}
		i += 1;
	}

	if (good)
	{
		println("factorial is good!!");
	}
	else
	{
		println("factorial is not good :(");
	}

	let n = 2;
	print_int32(n);
	set_to_zero(n);
	print_int32(n);

	println("\n==== ref_test ====");
	ref_test();

	println("\n==== cast_test ====");
	cast_test();

	return 0;
/*
	let bool: bool = false;
	while (bool)
	{
		bool = false;
	}
	print("hello");
	let n: int32 = 0;
	change_val(n);
	let str = "hello";
	let str2 = "hello"; /* nested comment */
	return factorial(1);
*/
}

function set_to_zero(n: &int32) -> void
{
	n = 0;
}

function foo() -> void
{
	let i8 = 0i8;
	let i16 = 0i16;
	let i32 = 0i32;
	let i64 = 0i64;
	let u8 = 0u8;
	let u16 = 0u16;
	let u32 = 0u32;
	let u64 = 0u64;

	i8 == i8;
//	i8 == u8;
	i8 == i16;
	u8 == u64;
	u8 < u64;

	u16 -= u8;
	let p = &i8;
	p -= u64;

	u16 /= u8;
	i16 /= i8;

	i32 = -5;
	i8 = 2i8;
	i32 /= i8;
	print_int32(i32);

	i32 = 1234;
	i16 = 111i16;
	i32 %= i16;
	print_int32(i32);
	print_int32(1234 / 111);
	print_int32(11 * 111 + 13);

	let a = 'a';
	let b = 'c' + -1i8;

	if (a == 'a')
		println("a == 'a'");
	else
		println("a != 'a'");

	if (
		'a' + 1 == 'b'
		&& 'c' + -1 == 'b'
		&& 'c' + -1i8 == 'b'
		&& 'c' - 1 == 'b'
		&& 'a' - -1 == 'b'
		&& 'a' - -1i8 == 'b'
	)
		println("b == 'b'");
	else
		println("b != 'b'");

	const a = 1.0 * 0.5;
	if (a == 0.5)
	{
		println("yay");
	}

	let n = 0xffu32;
	const mask = 0x46u32;
	n &= mask;
	if (n == mask)
		println("yay!!");

	let n = 1;
	let m = 0;
	(n = m = 2) = m;
	if (n == 0 && m == 2)
		println("yay again!");

	let n = 1u32;
	n <<= 3u8;
	print_uint32(n);
	n >>= 1u8;
	print_uint32(n);
	let m = 5u32;
	n += m = 2u32;
	if (n == 6u32)
	{
		println("yay yet again!");
	}
}

function ref_test() -> void
{
	function change_n(n: &int32) -> void
	{
		n = 1234;
	}
	let n = 0;
	print_int32(n);
	change_n(n);
	print_int32(n);

	function foo(n: int32) -> void { print_int32_ptr(&n); }
	function foo_ref(n: &const int32) -> void { print_int32_ptr(&n); }

	print_int32_ptr(&n);
	foo(n);
	foo_ref(n);
	println("first and third pointers should be the same");

	let &m = n;
	if (&m != &n)
	{
		println("BAD");
		return;
	}
	print_int32_ptr(&m);
	foo(m);
	foo_ref(m);
	println("first and third pointers should be the same");

//	asdfasdf([0, 1, 2, 3, 4, 5]);
}

function cast_test() -> void
{
	let f32: float32 = 1.5 as float32;
	print_float64(f32 as float64);
	print_int32(f32 as int32);

//	function ref_wrapper(n: &int32) -> &int32
//	{ return n; }
//
//	let n = 0;
//
//	print_int32(n);
//	ref_wrapper(n) = 3;
//	print_int32(n);

//	let v: vec2;
}

// function asdfasdf(t: [int32, int32, int32, int32, int32, int32]) -> void;

struct vec2
{
	x: float64;
	y: float64;
}
